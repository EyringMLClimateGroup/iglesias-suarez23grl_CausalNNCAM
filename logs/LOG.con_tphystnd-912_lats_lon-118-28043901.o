# pipeline
# cfg_pipeline.yml
---
documentation:
  description: Options (specifications) for the "pipeline" script.

  authors:
    - solino-fernandez_breixo
    - iglesias-suarez_fernando

  maintainer:
    - solino-fernandez_breixo
    - iglesias-suarez_fernando

  references:
    - acknow_project

  projects:
    - usmile


# # Specifications
# analysis       : 'single' # 'single': gridpoints individually; 
#                           # 'concat': gridpoints contatenated into a 
#                           #           single time-series; 
# spcam_parents  : ['tbp','qbp','vbp','ps','solin','shflx','lhflx']
# #spcam_parents  : ['tbp','ps']
# #spcam_children : ['tphystnd','phq','prect','fsns','flns','fsnt','flnt']
# spcam_children : ['tphystnd','phq','fsns','flns','fsnt','flnt']
# #spcam_children : ['tphystnd']
# pc_alphas      : [0.001,0.002,0.005,0.01,0.02,0.05,0.1,0.2]
# #pc_alphas      : [0.01]
# region         : [ [-90,90] , [120,120] ] # Lons: 120, 118
# lim_levels     : False # [950, 750] # False
# target_levels  : [3.643, 54.595, 103.317, 197.908, 379.100, 524.687, 763.404, 859.534, 912.644, 957.485] # False
# output_folder  : "./causal_links"
# #output_folder  : "./test_causal_links"
# verbosity      : 2
# output_file_pattern :
#   single: "{var_name}_{level}_lat-{lat}_lon-{lon}_{experiment}.obj"
#   concat: "{var_name}_{level}_{lat1}-{lat2}_{lon1}-{lon2}_{experiment}.obj"

# Specifications
analysis       : 'concat' # 'single': gridpoints individually; 
                          # 'concat': gridpoints contatenated into a 
                          #           single time-series; 
spcam_parents  : ['tbp','qbp','vbp','ps','solin','shflx','lhflx']
#spcam_parents  : ['tbp','ps']
#spcam_children : ['tphystnd','phq','prect','fsns','flns','fsnt','flnt']
#spcam_children : ['tphystnd','phq','fsns','flns','fsnt','flnt']
spcam_children : ['tphystnd']
pc_alphas      : [0.001,0.002,0.005,0.01,0.02,0.05,0.1,0.2]
#pc_alphas      : [0.01]
region         : [ [-90,90] , [120,120] ] # Lons: 120, 118
lim_levels     : False # [950, 750] # False
target_levels  : [912.644] # [3.643, 54.595, 103.317, 197.908, 379.100, 524.687, 763.404, 859.534, 912.644, 957.485] # False
output_folder  : "./causal_links"
#output_folder  : "./test_causal_links"
verbosity      : 2
output_file_pattern :
  single: "{var_name}_{level}_lat-{lat}_lon-{lon}_{experiment}.obj"
  concat: "{var_name}_{level}_{lat1}-{lat2}_{lon1}-{lon2}_{experiment}.obj"Convert jupyter notebook into python script
[NbConvertApp] Converting notebook pipeline.ipynb to script
[NbConvertApp] Writing 4120 bytes to pipeline.py

Run PCMCI
Analysis: concat

2021-02-24 10:04:44.354978 Variable: tphystnd

Load Parents (state fields)...
2021-02-24 10:04:44.355483 Gridpoint 1/64: lat=-87.86379883923263 (0), lon=120.9375 (43)
2021-02-24 10:12:54.266062 Gridpoint 2/64: lat=-85.09652698831736 (1), lon=120.9375 (43)
2021-02-24 10:14:35.801635 Gridpoint 3/64: lat=-82.31291294788628 (2), lon=120.9375 (43)
2021-02-24 10:16:16.952684 Gridpoint 4/64: lat=-79.52560657265944 (3), lon=120.9375 (43)
2021-02-24 10:17:37.818603 Gridpoint 5/64: lat=-76.73689968036831 (4), lon=120.9375 (43)
2021-02-24 10:19:08.284447 Gridpoint 6/64: lat=-73.94751515398967 (5), lon=120.9375 (43)
2021-02-24 10:20:27.990020 Gridpoint 7/64: lat=-71.15775201158732 (6), lon=120.9375 (43)
2021-02-24 10:21:49.991423 Gridpoint 8/64: lat=-68.36775610831316 (7), lon=120.9375 (43)
2021-02-24 10:23:09.930890 Gridpoint 9/64: lat=-65.57760701082782 (8), lon=120.9375 (43)
2021-02-24 10:24:32.751366 Gridpoint 10/64: lat=-62.787351798963066 (9), lon=120.9375 (43)
2021-02-24 10:26:01.851372 Gridpoint 11/64: lat=-59.9970201084913 (10), lon=120.9375 (43)
2021-02-24 10:27:32.565988 Gridpoint 12/64: lat=-57.20663152764324 (11), lon=120.9375 (43)
2021-02-24 10:29:02.280895 Gridpoint 13/64: lat=-54.4161995260862 (12), lon=120.9375 (43)
2021-02-24 10:30:32.477317 Gridpoint 14/64: lat=-51.625733674938246 (13), lon=120.9375 (43)
2021-02-24 10:32:03.468807 Gridpoint 15/64: lat=-48.83524096625058 (14), lon=120.9375 (43)
2021-02-24 10:33:34.977994 Gridpoint 16/64: lat=-46.04472663110168 (15), lon=120.9375 (43)
2021-02-24 10:35:05.808599 Gridpoint 17/64: lat=-43.25419466535094 (16), lon=120.9375 (43)
2021-02-24 10:36:36.428888 Gridpoint 18/64: lat=-40.46364817811504 (17), lon=120.9375 (43)
2021-02-24 10:37:55.937066 Gridpoint 19/64: lat=-37.67308962904533 (18), lon=120.9375 (43)
2021-02-24 10:39:13.740052 Gridpoint 20/64: lat=-34.88252099377346 (19), lon=120.9375 (43)
2021-02-24 10:40:39.625820 Gridpoint 21/64: lat=-32.091943881744015 (20), lon=120.9375 (43)
2021-02-24 10:42:12.280039 Gridpoint 22/64: lat=-29.30135962176273 (21), lon=120.9375 (43)
2021-02-24 10:43:31.499438 Gridpoint 23/64: lat=-26.510769325210994 (22), lon=120.9375 (43)
2021-02-24 10:44:48.064945 Gridpoint 24/64: lat=-23.72017393353475 (23), lon=120.9375 (43)
2021-02-24 10:46:13.909523 Gridpoint 25/64: lat=-20.929574254489513 (24), lon=120.9375 (43)
2021-02-24 10:47:34.494535 Gridpoint 26/64: lat=-18.13897099023935 (25), lon=120.9375 (43)
2021-02-24 10:49:01.935263 Gridpoint 27/64: lat=-15.348364759491494 (26), lon=120.9375 (43)
2021-02-24 10:50:27.569060 Gridpoint 28/64: lat=-12.557756115230678 (27), lon=120.9375 (43)
2021-02-24 10:51:54.318759 Gridpoint 29/64: lat=-9.76714555919557 (28), lon=120.9375 (43)
2021-02-24 10:53:14.194482 Gridpoint 30/64: lat=-6.976533553948636 (29), lon=120.9375 (43)
2021-02-24 10:54:40.398744 Gridpoint 31/64: lat=-4.185920533189154 (30), lon=120.9375 (43)
2021-02-24 10:56:05.191210 Gridpoint 32/64: lat=-1.395306910819496 (31), lon=120.9375 (43)
2021-02-24 10:57:27.956323 Gridpoint 33/64: lat=1.395306910819496 (32), lon=120.9375 (43)
2021-02-24 10:58:49.500833 Gridpoint 34/64: lat=4.185920533189154 (33), lon=120.9375 (43)
2021-02-24 11:00:13.973699 Gridpoint 35/64: lat=6.976533553948636 (34), lon=120.9375 (43)
2021-02-24 11:01:45.092750 Gridpoint 36/64: lat=9.76714555919557 (35), lon=120.9375 (43)
2021-02-24 11:03:16.293284 Gridpoint 37/64: lat=12.557756115230678 (36), lon=120.9375 (43)
2021-02-24 11:04:47.339507 Gridpoint 38/64: lat=15.348364759491494 (37), lon=120.9375 (43)
2021-02-24 11:06:18.882085 Gridpoint 39/64: lat=18.13897099023935 (38), lon=120.9375 (43)
2021-02-24 11:07:51.887794 Gridpoint 40/64: lat=20.929574254489513 (39), lon=120.9375 (43)
2021-02-24 11:09:34.779786 Gridpoint 41/64: lat=23.72017393353475 (40), lon=120.9375 (43)
2021-02-24 11:17:32.171858 Gridpoint 42/64: lat=26.510769325210994 (41), lon=120.9375 (43)
2021-02-24 11:19:15.635116 Gridpoint 43/64: lat=29.30135962176273 (42), lon=120.9375 (43)
2021-02-24 11:20:56.660408 Gridpoint 44/64: lat=32.091943881744015 (43), lon=120.9375 (43)
2021-02-24 11:22:36.575991 Gridpoint 45/64: lat=34.88252099377346 (44), lon=120.9375 (43)
2021-02-24 11:24:11.563991 Gridpoint 46/64: lat=37.67308962904533 (45), lon=120.9375 (43)
2021-02-24 11:25:46.241329 Gridpoint 47/64: lat=40.46364817811504 (46), lon=120.9375 (43)
2021-02-24 11:27:08.073362 Gridpoint 48/64: lat=43.25419466535094 (47), lon=120.9375 (43)
2021-02-24 11:28:38.432791 Gridpoint 49/64: lat=46.04472663110168 (48), lon=120.9375 (43)
2021-02-24 11:30:05.686323 Gridpoint 50/64: lat=48.83524096625058 (49), lon=120.9375 (43)
2021-02-24 11:31:36.796141 Gridpoint 51/64: lat=51.625733674938246 (50), lon=120.9375 (43)
2021-02-24 11:33:08.030015 Gridpoint 52/64: lat=54.4161995260862 (51), lon=120.9375 (43)
2021-02-24 11:34:38.761654 Gridpoint 53/64: lat=57.20663152764324 (52), lon=120.9375 (43)
2021-02-24 11:36:13.897578 Gridpoint 54/64: lat=59.9970201084913 (53), lon=120.9375 (43)
2021-02-24 11:37:40.157095 Gridpoint 55/64: lat=62.787351798963066 (54), lon=120.9375 (43)
2021-02-24 11:39:12.465196 Gridpoint 56/64: lat=65.57760701082782 (55), lon=120.9375 (43)
2021-02-24 11:40:47.052442 Gridpoint 57/64: lat=68.36775610831316 (56), lon=120.9375 (43)
2021-02-24 11:42:21.259453 Gridpoint 58/64: lat=71.15775201158732 (57), lon=120.9375 (43)
2021-02-24 11:43:51.863842 Gridpoint 59/64: lat=73.94751515398967 (58), lon=120.9375 (43)
2021-02-24 11:45:21.582407 Gridpoint 60/64: lat=76.73689968036831 (59), lon=120.9375 (43)
2021-02-24 11:46:47.279414 Gridpoint 61/64: lat=79.52560657265944 (60), lon=120.9375 (43)
2021-02-24 11:48:11.631545 Gridpoint 62/64: lat=82.31291294788628 (61), lon=120.9375 (43)
2021-02-24 11:49:35.167848 Gridpoint 63/64: lat=85.09652698831736 (62), lon=120.9375 (43)
2021-02-24 11:51:03.752047 Gridpoint 64/64: lat=87.86379883923263 (63), lon=120.9375 (43)
Parents shape:  (94, 1118144)
2021-02-24 11:52:31.431943 All parents loaded. Time: 1:47:47.076435

Load tphystnd...
2021-02-24 11:52:31.431983 Gridpoint 1/64: lat=-87.86379883923263 (0), lon=120.9375 (43)
2021-02-24 11:52:36.956087 Gridpoint 2/64: lat=-85.09652698831736 (1), lon=120.9375 (43)
2021-02-24 11:52:39.647813 Gridpoint 3/64: lat=-82.31291294788628 (2), lon=120.9375 (43)
2021-02-24 11:52:42.153554 Gridpoint 4/64: lat=-79.52560657265944 (3), lon=120.9375 (43)
2021-02-24 11:52:44.832684 Gridpoint 5/64: lat=-76.73689968036831 (4), lon=120.9375 (43)
2021-02-24 11:52:47.460596 Gridpoint 6/64: lat=-73.94751515398967 (5), lon=120.9375 (43)
2021-02-24 11:52:49.984411 Gridpoint 7/64: lat=-71.15775201158732 (6), lon=120.9375 (43)
2021-02-24 11:52:52.731631 Gridpoint 8/64: lat=-68.36775610831316 (7), lon=120.9375 (43)
2021-02-24 11:52:55.357515 Gridpoint 9/64: lat=-65.57760701082782 (8), lon=120.9375 (43)
2021-02-24 11:52:58.098846 Gridpoint 10/64: lat=-62.787351798963066 (9), lon=120.9375 (43)
2021-02-24 11:53:00.753061 Gridpoint 11/64: lat=-59.9970201084913 (10), lon=120.9375 (43)
2021-02-24 11:53:03.381447 Gridpoint 12/64: lat=-57.20663152764324 (11), lon=120.9375 (43)
2021-02-24 11:53:05.982815 Gridpoint 13/64: lat=-54.4161995260862 (12), lon=120.9375 (43)
2021-02-24 11:53:08.667807 Gridpoint 14/64: lat=-51.625733674938246 (13), lon=120.9375 (43)
2021-02-24 11:53:11.279154 Gridpoint 15/64: lat=-48.83524096625058 (14), lon=120.9375 (43)
2021-02-24 11:53:13.807075 Gridpoint 16/64: lat=-46.04472663110168 (15), lon=120.9375 (43)
2021-02-24 11:53:16.437412 Gridpoint 17/64: lat=-43.25419466535094 (16), lon=120.9375 (43)
2021-02-24 11:53:19.036948 Gridpoint 18/64: lat=-40.46364817811504 (17), lon=120.9375 (43)
2021-02-24 11:53:21.458868 Gridpoint 19/64: lat=-37.67308962904533 (18), lon=120.9375 (43)
2021-02-24 11:53:23.814984 Gridpoint 20/64: lat=-34.88252099377346 (19), lon=120.9375 (43)
2021-02-24 11:53:26.337828 Gridpoint 21/64: lat=-32.091943881744015 (20), lon=120.9375 (43)
2021-02-24 11:53:28.877719 Gridpoint 22/64: lat=-29.30135962176273 (21), lon=120.9375 (43)
2021-02-24 11:53:31.518493 Gridpoint 23/64: lat=-26.510769325210994 (22), lon=120.9375 (43)
2021-02-24 11:53:34.039436 Gridpoint 24/64: lat=-23.72017393353475 (23), lon=120.9375 (43)
2021-02-24 11:53:36.598021 Gridpoint 25/64: lat=-20.929574254489513 (24), lon=120.9375 (43)
2021-02-24 11:53:39.158833 Gridpoint 26/64: lat=-18.13897099023935 (25), lon=120.9375 (43)
2021-02-24 11:53:41.727345 Gridpoint 27/64: lat=-15.348364759491494 (26), lon=120.9375 (43)
2021-02-24 11:53:44.204046 Gridpoint 28/64: lat=-12.557756115230678 (27), lon=120.9375 (43)
2021-02-24 11:53:46.754853 Gridpoint 29/64: lat=-9.76714555919557 (28), lon=120.9375 (43)
2021-02-24 11:53:49.333854 Gridpoint 30/64: lat=-6.976533553948636 (29), lon=120.9375 (43)
2021-02-24 11:53:51.958246 Gridpoint 31/64: lat=-4.185920533189154 (30), lon=120.9375 (43)
2021-02-24 11:53:54.203434 Gridpoint 32/64: lat=-1.395306910819496 (31), lon=120.9375 (43)
2021-02-24 11:53:56.586301 Gridpoint 33/64: lat=1.395306910819496 (32), lon=120.9375 (43)
2021-02-24 11:53:59.216085 Gridpoint 34/64: lat=4.185920533189154 (33), lon=120.9375 (43)
2021-02-24 11:54:01.907707 Gridpoint 35/64: lat=6.976533553948636 (34), lon=120.9375 (43)
2021-02-24 11:54:04.617460 Gridpoint 36/64: lat=9.76714555919557 (35), lon=120.9375 (43)
2021-02-24 11:54:07.354950 Gridpoint 37/64: lat=12.557756115230678 (36), lon=120.9375 (43)
2021-02-24 11:54:10.012222 Gridpoint 38/64: lat=15.348364759491494 (37), lon=120.9375 (43)
2021-02-24 11:54:12.748569 Gridpoint 39/64: lat=18.13897099023935 (38), lon=120.9375 (43)
2021-02-24 11:54:15.622757 Gridpoint 40/64: lat=20.929574254489513 (39), lon=120.9375 (43)
2021-02-24 11:54:18.330268 Gridpoint 41/64: lat=23.72017393353475 (40), lon=120.9375 (43)
2021-02-24 11:54:20.979988 Gridpoint 42/64: lat=26.510769325210994 (41), lon=120.9375 (43)
2021-02-24 11:54:23.802998 Gridpoint 43/64: lat=29.30135962176273 (42), lon=120.9375 (43)
2021-02-24 11:54:26.624116 Gridpoint 44/64: lat=32.091943881744015 (43), lon=120.9375 (43)
2021-02-24 11:54:29.421750 Gridpoint 45/64: lat=34.88252099377346 (44), lon=120.9375 (43)
2021-02-24 11:54:32.173375 Gridpoint 46/64: lat=37.67308962904533 (45), lon=120.9375 (43)
2021-02-24 11:54:34.985187 Gridpoint 47/64: lat=40.46364817811504 (46), lon=120.9375 (43)
2021-02-24 11:54:37.768707 Gridpoint 48/64: lat=43.25419466535094 (47), lon=120.9375 (43)
2021-02-24 11:54:40.486979 Gridpoint 49/64: lat=46.04472663110168 (48), lon=120.9375 (43)
2021-02-24 11:54:43.289366 Gridpoint 50/64: lat=48.83524096625058 (49), lon=120.9375 (43)
2021-02-24 11:54:46.185355 Gridpoint 51/64: lat=51.625733674938246 (50), lon=120.9375 (43)
2021-02-24 11:54:49.023610 Gridpoint 52/64: lat=54.4161995260862 (51), lon=120.9375 (43)
2021-02-24 11:54:51.795710 Gridpoint 53/64: lat=57.20663152764324 (52), lon=120.9375 (43)
2021-02-24 11:54:54.566284 Gridpoint 54/64: lat=59.9970201084913 (53), lon=120.9375 (43)
2021-02-24 11:54:57.452194 Gridpoint 55/64: lat=62.787351798963066 (54), lon=120.9375 (43)
2021-02-24 11:55:00.294864 Gridpoint 56/64: lat=65.57760701082782 (55), lon=120.9375 (43)
2021-02-24 11:55:02.951259 Gridpoint 57/64: lat=68.36775610831316 (56), lon=120.9375 (43)
2021-02-24 11:55:05.629115 Gridpoint 58/64: lat=71.15775201158732 (57), lon=120.9375 (43)
2021-02-24 11:55:08.361164 Gridpoint 59/64: lat=73.94751515398967 (58), lon=120.9375 (43)
2021-02-24 11:55:11.139484 Gridpoint 60/64: lat=76.73689968036831 (59), lon=120.9375 (43)
2021-02-24 11:55:13.971686 Gridpoint 61/64: lat=79.52560657265944 (60), lon=120.9375 (43)
2021-02-24 11:55:16.500830 Gridpoint 62/64: lat=82.31291294788628 (61), lon=120.9375 (43)
2021-02-24 11:55:19.417894 Gridpoint 63/64: lat=85.09652698831736 (62), lon=120.9375 (43)
2021-02-24 11:55:22.127024 Gridpoint 64/64: lat=87.86379883923263 (63), lon=120.9375 (43)
Child shape:  (1, 1118144)
2021-02-24 11:55:24.919035 Child loaded. Time: 0:02:53.487049

2021-02-24 11:55:24.936871 Finding links for tphystnd at level 26
2021-02-24 14:23:06.898007 Links found. Time: 2:27:41.918558 Total time so far: 4:18:22.542784

Saved results into "./causal_links/tphystnd_26_-87-87_120-120_002_train_1_year.obj"
2021-02-24 14:23:06.994403 Execution complete. Total time: 4:18:22.639420
rm: cannot remove `pipeline.py': No such file or directory
mv: cannot create regular file `/LOG.con_tphystnd-912_lats_lon-118-28043901.o': Permission denied

---------- Finished /var/log/slurm/spool_slurmd//job28043901/slurm_script ----------

********************************************************************************
*                                                                              *
*  This is the automated job summary provided by DKRZ.                         *
*  If you encounter problems, need assistance or have any suggestion, please   *
*  write an email to                                                           *
*                                                                              *
*  --  beratung@dkrz.de --                                                     *
*                                                                              *
*                       We hope you enjoyed the DKRZ supercomputer MISTRAL ... *
*
* JobID            : 28043901
* JobName          : con_tphystnd-912_lats_lon-118                     
* Account          : bd1179
* User             : b309172 (25575), bd0854 (1473)                    
* Partition        : compute
* QOS              : normal
* Nodelist         : m10287 (1)                                                
* AvgCommBlocking  : 0.0000 (in [0,4] less is better)
* Submit date      : 2021-02-24T10:03:57
* Start time       : 2021-02-24T10:04:01
* End time         : 2021-02-24T14:23:12
* Elapsed time     : 04:19:11 (Timelimit=08:00:00)                     
* Command          : /mnt/lustre02/work/bd1179/b309172/analysis/usmile/
*                    causality_convection/python/causalnncam/compute_slurm_job_pipeline.sh
* WorkDir          : /mnt/lustre02/work/bd1179/b309172/analysis/usmile/
*                    causality_convection/python/causalnncam
*
* StepID | JobName      NodeHours    MaxRSS [Byte] (@task)   ReqCPUFreq [Hz]
* ------------------------------------------------------------------------------
* batch  | batch              4.3
* ------------------------------------------------------------------------------

